<script>
    var KTAppOptions = {
        "colors": {
            "state": {
                "brand": "#5d78ff",
                "light": "#ffffff",
                "dark": "#282a3c",
                "primary": "#5867dd",
                "success": "#34bfa3",
                "info": "#36a3f7",
                "warning": "#ffb822",
                "danger": "#fd3995"
            },
            "base": {
                "label": ["#c5cbe3", "#a1a8c3", "#3d4465", "#3e4466"],
                "shape": ["#f0f3ff", "#d9dffa", "#afb4d4", "#646c9a"]
            }
        }
    };

    function formatDate(date) {
        var d = new Date(date),
            month = '' + (d.getMonth() + 1),
            day = '' + d.getDate(),
            year = d.getFullYear();

        if (month.length < 2) month = '0' + month;
        if (day.length < 2) day = '0' + day;

        return [year, month, day].join('-');
    }
</script>

<!-- end::Global Config -->
<!--begin::Global Theme Bundle(used by all pages) -->
<!--<script src="/check/assets/js/pages/custom/wizard/wizard-1.js" type="text/javascript"></script>-->

<script src="/check/assets/plugins/global/plugins.bundle.js" type="text/javascript"></script>
<script src="/check/assets/js/scripts.bundle.js" type="text/javascript"></script>
<script src="/check/assets/plugins/custom/prismjs/prismjs.bundle.js" type="text/javascript"></script>

<!--end::Global Theme Bundle -->

<!--begin::Page Vendors(used by this page) -->
<script src="/check/assets/plugins/custom/fullcalendar/fullcalendar.bundle.js" type="text/javascript"></script>
<script src="/check/assets/plugins/custom/datatables/datatables.bundle.js" type="text/javascript"></script>
{{/*
<script src="//maps.google.com/maps/api/js?key=AIzaSyBTGnKT7dt597vo9QgeQ7BFhvSRP4eiMSM"
        type="text/javascript"></script>*/}}
{{/*
<script src="/check/assets/plugins/custom/gmaps/gmaps.js" type="text/javascript"></script>*/}}

<!--end::Page Vendors -->

<!--begin::Page Scripts(used by this page) -->
{{/*
<script src="/check/assets/js/pages/dashboard.js" type="text/javascript"></script>*/}}
<script src="/check/assets/js/pages/custom/user/profile.js" type="text/javascript"></script>
<script src="/check/assets/js/pages/jquery.date-dropdowns.min.js" type="text/javascript"></script>
<script src="/check/assets/js/pages/crud/datatables/basic/scrollable.js" type="text/javascript"></script>
<script src="/check/assets/plugins/custom/datatables/datatables.bundle.js" type="text/javascript"></script>
<script src="/check/assets/js/pages/crud/forms/widgets/select2.js" type="text/javascript"></script>
<script>
    $('#download').hide();

    $('#user , #kt_daterangepicker_1').click(function () {
        $('#download').hide();
    })

    function excel() {
        var date_range = $('#kt_daterangepicker_1').val();
        var dates = date_range.split(" - ");
        var start = formatDate(dates[0], "yyyy-MM-dd");
        var end = formatDate(dates[1], "yyyy-MM-dd");
        id = $('#user').val()

        Data = {
            'start': start,
            'end': end,
            'id': id
        }
        $.ajax({
            url: "/check/export/excel",
            data: Data,
            type: "POST",
            success: function (data) {
                console.log("DATA : ",data)
                console.log("DATA : ",data.recordsTotal)
                console.log("DATA : ",data.data[0].name)

                $('#download').show();
                $('#table-home').remove()

                let text = ""
                for (let i = 0; i < data.recordsTotal; i++) {
                    console.log("log, : ", i)

                    text += `<tr>
                            <td>`+data.data[i].name +`</td>
                            <td>`+data.data[i].location +`</td>
                            <td>`+data.data[i].check_in +`</td>
                            <td>`+data.data[i].check_out +`</td></tr>`;

                    console.log("text, : ", text)
                }

                $('#append-here').append(`
                <div class="kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid" id="table-home">
                <table class="table table-striped- table-bordered table-hover table-checkable" id="kt_table_home"
                       style="width: 100%">
                    <thead>
                    <tr>
                        <th>Name</th>
                        <th>Location</th>
                        <th>Check IN</th>
                        <th>Check OUT</th>
                    </tr>
                    </thead>
                    <tbody>
                    `+text+`
                    </tbody>
                </table>
            </div>

                `)
            },

        })

    }


    $('#kt_daterangepicker_1').daterangepicker({
        buttonClasses: ' btn',
        applyClass: 'btn-primary',
        cancelClass: 'btn-secondary'
    });

    $('#user').select2({
        width: 'resolve',
        placeholder: "Select User",
    });

    $.ajax({
        url: "/check/admin/register/all",
        type: "GET",
        success: function (res) {
            var dataModel = []
            $.each(res, function (i, val) {
                console.log("VAL : ", val)
                dataModel.push({
                    id: val.user_id,
                    text: val.name
                })
            })
            $('#user').select2({
                placeholder: "User Name",
                data: dataModel
            });
        },
    })

    $('#kt_table_home').DataTable({
        destroy: true,
        processing: true,
        serverSide: true,
        lengthChange: true,
        // fixedColumns: true,
        autoWidth: false,
        scrollX: true,
        // scrollY: '50vh',
        scrollCollapse: true,
        fixedHeader: {
            "header": false,
            "footer": false
        },
        ajax: '/check/admin/home/datatable',
        columns: [
            {data: 'name', name: 'name'},
            {data: 'location', name: 'location'},
            {data: 'check_in', name: 'check_in'},
            {data: 'check_out', name: 'check_out'},
        ],
    });
</script>

